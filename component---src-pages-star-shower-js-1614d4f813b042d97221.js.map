{"version":3,"sources":["webpack:///./src/utils/index.js","webpack:///./src/classes/FallingStar.js","webpack:///./src/pages/star-shower.js","webpack:///./node_modules/core-js/modules/es6.array.fill.js","webpack:///./node_modules/core-js/modules/_array-fill.js"],"names":["randomIntFromRange","min","max","Math","floor","random","FallingStar","ctx","x","y","radius","color","floorSize","draw","save","beginPath","arc","PI","shadowColor","shadowBlur","fillStyle","fill","closePath","restore","shatter","Array","from","forEach","p","StarParticle","particles","push","animate","console","log","velocity","window","innerHeight","friction","gravity","innerWidth","this","props","opacity","ttl","IndexPage","canvas","useRef","animationFrame","stars","bgStars","ticker","onResizeHandler","setCanvasSize","current","width","height","drawMountains","numMountains","mountainWidth","idx","moveTo","lineTo","clearCanvas","getContext","bg","createLinearGradient","addColorStop","fillRect","length","star","drawBgStars","rect","drawFloor","getNewStar","useEffect","addEventListener","spawnRate","splice","particle","pidx","newStar","nextSpawn","requestAnimationFrame","removeEventListener","cancelAnimationFrame","title","ref","$export","P","toObject","toAbsoluteIndex","toLength","module","exports","value","O","aLen","arguments","index","undefined","end","endPos"],"mappings":"mJAAMA,EAAqB,SAACC,EAAKC,GAAN,OACzBC,KAAKC,MAAMD,KAAKE,UAAYH,EAAMD,EAAM,GAAKA,I,ICCzCK,EACJ,YAAsD,IAAD,OAAvCC,EAAuC,EAAvCA,IAAKC,EAAkC,EAAlCA,EAAGC,EAA+B,EAA/BA,EAAGC,EAA4B,EAA5BA,OAAQC,EAAoB,EAApBA,MAAOC,EAAa,EAAbA,UAAa,KAgBrDC,KAAO,WAAO,IACJN,EAA6B,EAA7BA,IAAKC,EAAwB,EAAxBA,EAAGC,EAAqB,EAArBA,EAAGC,EAAkB,EAAlBA,OAAQC,EAAU,EAAVA,MAC3BJ,EAAIO,OACJP,EAAIQ,YACJR,EAAIS,IAAIR,EAAGC,EAAGC,EAAQ,EAAa,EAAVP,KAAKc,IAAQ,GACtCV,EAAIW,YAAc,EAAKP,MACvBJ,EAAIY,WAAa,EACjBZ,EAAIa,UAAYT,EAChBJ,EAAIc,OACJd,EAAIe,YACJf,EAAIgB,WA1B+C,KA6BrDC,QAAU,WAAO,IACPjB,EAAiC,EAAjCA,IAAKC,EAA4B,EAA5BA,EAAGC,EAAyB,EAAzBA,EAAGC,EAAsB,EAAtBA,OAAQE,EAAc,EAAdA,UAE3B,EAAKF,OAASA,EAAS,EACvBe,MAAMC,KAAK,IAAID,MAAM,IAAIE,SAAQ,WAC/B,IAAMC,EAAI,IAAIC,EAAa,CACzBtB,MACAC,IACAC,IACAC,OAAQA,EAAS,EACjBE,cAEF,EAAKkB,UAAUC,KAAKH,OAzC6B,KA6CrDI,QAAU,WACRC,QAAQC,IAAI,EAAKtB,WAEf,EAAKH,EAAI,EAAKC,OAAS,EAAKyB,SAAS1B,EACrC2B,OAAOC,YAAc,EAAKzB,WAE1B,EAAKuB,SAAS1B,GAAK,EAAK0B,SAAS1B,EAAI,EAAK6B,SAC1C,EAAKd,WAEL,EAAKW,SAAS1B,GAAK,EAAK8B,SAIxB,EAAK/B,EAAI,EAAKE,OAAS,EAAKyB,SAAS3B,EAAI4B,OAAOI,YAChD,EAAKhC,EAAI,EAAKE,QAAU,KAExB,EAAKyB,SAAS3B,GAAK,EAAK2B,SAAS3B,GAGnC,EAAKA,GAAK,EAAK2B,SAAS3B,EACxB,EAAKC,GAAK,EAAK0B,SAAS1B,EAExB,EAAKI,QAlEL4B,KAAKlC,IAAMA,EACXkC,KAAKjC,EAAIA,EACTiC,KAAKhC,EAAIA,EACTgC,KAAK/B,OAASA,EACd+B,KAAK9B,MAAQA,GAAS,UACtB8B,KAAK7B,UAAYA,EACjB6B,KAAKN,SAAW,CACd3B,EAAGR,GAAoB,EAAG,GAC1BS,EAAGT,EAAmB,EAAG,KAE3ByC,KAAKH,SAAW,GAChBG,KAAKF,QAAU,GACfE,KAAKX,UAAY,IA0DfD,E,oBACJ,WAAYa,GAAQ,IAAD,SACjB,cAAMA,IAAN,MAUF7B,KAAO,WAAM,M,yHAAA,IAEHN,EAFG,EAEHA,IAAKC,EAFF,EAEEA,EAAGC,EAFL,EAEKA,EAAGC,EAFR,EAEQA,OAAQC,EAFhB,EAEgBA,MAC3BJ,EAAIO,OACJP,EAAIQ,YACJR,EAAIS,IAAIR,EAAGC,EAAGC,EAAQ,EAAa,EAAVP,KAAKc,IAAQ,GACtCV,EAAIa,UAAJ,uBAAuC,EAAKuB,QAA5C,IACApC,EAAIW,YAAcP,EAClBJ,EAAIY,WAAa,EACjBZ,EAAIc,OACJd,EAAIe,YACJf,EAAIgB,WAtBa,EAyBnBS,QAAU,WAEN,EAAKvB,EAAI,EAAKC,OAAS,EAAKyB,SAAS1B,EACrC2B,OAAOC,YAAc,EAAKzB,WAE1B,EAAKuB,SAAS1B,GAAK,EAAK0B,SAAS1B,EAAI,EAAK6B,SAC1C,EAAKd,WAEL,EAAKW,SAAS1B,GAAK,EAAK8B,SAIxB,EAAK/B,EAAI,EAAKE,OAAS,EAAKyB,SAAS3B,EAAI4B,OAAOI,YAChD,EAAKhC,EAAI,EAAKE,QAAU,KAExB,EAAKyB,SAAS3B,GAAK,EAAK2B,SAAS3B,GAGnC,EAAKA,GAAK,EAAK2B,SAAS3B,EACxB,EAAKC,GAAK,EAAK0B,SAAS1B,EACxB,EAAKmC,KAAO,EACZ,EAAKD,SAAW,EAAI,EAAKC,IACzB,EAAK/B,QA7CL,EAAK+B,IAAM,IACX,EAAKD,QAAU,EACf,EAAKR,SAAW,CACd3B,EAAGR,GAAoB,GAAI,IAC3BS,EAAGT,GAAoB,GAAI,KAE7B,EAAKa,OARY,E,iGADMP,GAoDZA,I,OCSAuC,UAjIG,WAChB,IAAMC,EAASC,iBAAO,MAChBC,EAAiBD,iBAAO,MACxBE,EAAQF,iBAAO,IACfG,EAAUH,iBAAO,IACjBI,EAASJ,iBAAO,GAGhBK,EAAkB,WACtBC,KAGIA,EAAgB,WACpBP,EAAOQ,QAAQC,MAAQnB,OAAOI,WAC9BM,EAAOQ,QAAQE,OAASpB,OAAOC,aAgB3BoB,EAAgB,SAAClD,EAAKmD,EAAcF,EAAQ7C,GAChD,IAAMgD,EAAgBb,EAAOQ,QAAQC,MAAQG,EAC7CjC,MAAMC,KAAK,IAAID,MAAMiC,IAAe/B,SAAQ,SAACnB,EAAGoD,GAC9CrD,EAAIQ,YACJR,EAAIsD,OAAOD,EAAMD,EAAeb,EAAOQ,QAAQE,QAC/CjD,EAAIuD,OACFF,EAAMD,EAAgBA,EAAgB,IACtCb,EAAOQ,QAAQE,QAEjBjD,EAAIuD,OACFF,EAAMD,EAAgBA,EAAgB,EACtCb,EAAOQ,QAAQE,OAASA,GAE1BjD,EAAIuD,OAAOF,EAAMD,EAAgB,IAAKb,EAAOQ,QAAQE,QACrDjD,EAAIa,UAAYT,EAChBJ,EAAIc,OACJd,EAAIe,gBAiBFyC,EAAc,WAClB,IAAMxD,EAAMuC,EAAOQ,QAAQU,WAAW,MAChCT,EAAQnB,OAAOI,WACfgB,EAASpB,OAAOC,YAChB4B,EAAK1D,EAAI2D,qBAAqB,EAAG,EAAG,EAAGV,GAC7CS,EAAGE,aAAa,EAAG,WACnBF,EAAGE,aAAa,EAAG,WACnB5D,EAAIa,UAAY6C,EAChB1D,EAAI6D,SAAS,EAAG,EAAGb,EAAOC,GAtDR,SAAAjD,GACb2C,EAAQI,QAAQe,QACnB5C,MAAMC,KAAK,IAAID,MAAM,MAAME,SAAQ,WACjC,IAAMjB,EAASV,EAAmB,EAAG,GAC/BQ,EAAIL,KAAKE,SAAWyC,EAAOQ,QAAQC,MACnC9C,EAAIN,KAAKE,SAAWyC,EAAOQ,QAAQE,OACzCN,EAAQI,QAAQvB,KAAK,IAAIzB,EAAY,CAAEC,MAAKC,IAAGC,IAAGC,eAItDwC,EAAQI,QAAQ3B,SAAQ,SAAA2C,GAAI,OAAIA,EAAKzD,UA6CrC0D,CAAYhE,GACZkD,EAAclD,EAAK,EAAGuC,EAAOQ,QAAQE,OAAS,IAAK,WACnDC,EAAclD,EAAK,EAAGuC,EAAOQ,QAAQE,OAAS,IAAK,WACnDC,EAAclD,EAAK,EAAGuC,EAAOQ,QAAQE,OAAS,IAAK,WAzBnC,SAAAjD,GAChBA,EAAIQ,YACJR,EAAIiE,KACF,EACA1B,EAAOQ,QAAQE,OAhDD,IAiDdV,EAAOQ,QAAQC,MAjDD,KAoDhBhD,EAAIa,UAAY,UAChBb,EAAIc,OACJd,EAAIe,YAgBJmD,CAAUlE,IA4BNmE,EAAa,SAAAnE,GACjB,IACMC,EAAIL,KAAKD,IADA,GACYC,KAAKE,SAAWyC,EAAOQ,QAAQC,MAD3C,IAGf,OAAO,IAAIjD,EAAY,CAAEC,MAAKC,IAAGC,GADtB,IACyBC,OAHrB,GAG6BE,UAtG5B,OAoHlB,OAXA+D,qBAAU,WAKR,OAJAtB,IACAjB,OAAOwC,iBAAiB,SAAUxB,GAClCJ,EAAeM,QAnCD,SAAVtB,EAAU6C,GACdd,IACAd,EAAMK,QAAQ3B,SAAQ,SAAC2C,EAAMV,GAC3BU,EAAKtC,UACD7B,KAAKC,MAAMkE,EAAK5D,SAAW,EAC7BuC,EAAMK,QAAQwB,OAAOlB,EAAK,GAE1BU,EAAKxC,UAAUH,SAAQ,SAACoD,EAAUC,GAChCD,EAAS/C,UACJ+C,EAASnC,KACZ0B,EAAKxC,UAAUgD,OAAOE,EAAM,SAKpC7B,EAAOG,UACP,IAAM2B,EAAU9B,EAAOG,QAAUuB,GAAc,EAC3CI,GACFhC,EAAMK,QAAQvB,KAAK2C,EAAW5B,EAAOQ,QAAQU,WAAW,QAE1D,IAAMkB,EAAYD,EAAUjF,EAAmB,IAAK,KAAO6E,EAE3D7B,EAAeM,QAAU6B,uBAAsB,kBAAMnD,EAAQkD,MAapClD,CAAQ,IAE1B,WACLI,OAAOgD,oBAAoB,SAAUhC,GACrCiC,qBAAqBrC,EAAeM,aAKtC,kBAAC,IAAD,CAAQgC,MAAM,eACZ,4BAAQC,IAAKzC,O,oBCjInB,IAAI0C,EAAU,EAAQ,GAEtBA,EAAQA,EAAQC,EAAG,QAAS,CAAEpE,KAAM,EAAQ,OAE5C,EAAQ,IAAR,CAAiC,S,iCCHjC,IAAIqE,EAAW,EAAQ,IACnBC,EAAkB,EAAQ,KAC1BC,EAAW,EAAQ,IACvBC,EAAOC,QAAU,SAAcC,GAO7B,IANA,IAAIC,EAAIN,EAASjD,MACb4B,EAASuB,EAASI,EAAE3B,QACpB4B,EAAOC,UAAU7B,OACjB8B,EAAQR,EAAgBM,EAAO,EAAIC,UAAU,QAAKE,EAAW/B,GAC7DgC,EAAMJ,EAAO,EAAIC,UAAU,QAAKE,EAChCE,OAAiBF,IAARC,EAAoBhC,EAASsB,EAAgBU,EAAKhC,GACxDiC,EAASH,GAAOH,EAAEG,KAAWJ,EACpC,OAAOC","file":"component---src-pages-star-shower-js-1614d4f813b042d97221.js","sourcesContent":["const randomIntFromRange = (min, max) =>\n  Math.floor(Math.random() * (max - min + 1) + min);\n\nconst getRandomItemFromArray = arr =>\n  arr[Math.floor(Math.random() * arr.length)];\n\nconst distance = (x1, y1, x2, y2) => {\n  const xDist = x2 - x1;\n  const yDist = y2 - y1;\n\n  return Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));\n};\n\nexport { randomIntFromRange, getRandomItemFromArray, distance };\n","import { randomIntFromRange } from '../utils';\n\nclass FallingStar {\n  constructor({ ctx, x, y, radius, color, floorSize }) {\n    this.ctx = ctx;\n    this.x = x;\n    this.y = y;\n    this.radius = radius;\n    this.color = color || '#e3eaef';\n    this.floorSize = floorSize;\n    this.velocity = {\n      x: randomIntFromRange(-5, 5),\n      y: randomIntFromRange(5, 10),\n    };\n    this.friction = 0.4;\n    this.gravity = 0.3;\n    this.particles = [];\n  }\n\n  draw = () => {\n    const { ctx, x, y, radius, color } = this;\n    ctx.save();\n    ctx.beginPath();\n    ctx.arc(x, y, radius, 0, Math.PI * 2, false);\n    ctx.shadowColor = this.color;\n    ctx.shadowBlur = 5;\n    ctx.fillStyle = color;\n    ctx.fill();\n    ctx.closePath();\n    ctx.restore();\n  };\n\n  shatter = () => {\n    const { ctx, x, y, radius, floorSize } = this;\n\n    this.radius = radius / 2;\n    Array.from(new Array(8)).forEach(() => {\n      const p = new StarParticle({\n        ctx,\n        x,\n        y,\n        radius: radius / 4,\n        floorSize,\n      });\n      this.particles.push(p);\n    });\n  };\n\n  animate = () => {\n    console.log(this.floorSize);\n    if (\n      this.y + this.radius + this.velocity.y >\n      window.innerHeight - this.floorSize\n    ) {\n      this.velocity.y = -this.velocity.y * this.friction;\n      this.shatter();\n    } else {\n      this.velocity.y += this.gravity;\n    }\n\n    if (\n      this.x + this.radius + this.velocity.x > window.innerWidth ||\n      this.x - this.radius <= 0\n    ) {\n      this.velocity.x = -this.velocity.x;\n    }\n\n    this.x += this.velocity.x;\n    this.y += this.velocity.y;\n\n    this.draw();\n  };\n}\n\nclass StarParticle extends FallingStar {\n  constructor(props) {\n    super(props);\n    this.ttl = 100;\n    this.opacity = 1;\n    this.velocity = {\n      x: randomIntFromRange(-10, 10),\n      y: randomIntFromRange(-20, 20),\n    };\n    this.draw();\n  }\n\n  draw = () => {\n    // Particle drawing\n    const { ctx, x, y, radius, color } = this;\n    ctx.save();\n    ctx.beginPath();\n    ctx.arc(x, y, radius, 0, Math.PI * 2, false);\n    ctx.fillStyle = `rgba(227, 234, 239, ${this.opacity})`;\n    ctx.shadowColor = color;\n    ctx.shadowBlur = 5;\n    ctx.fill();\n    ctx.closePath();\n    ctx.restore();\n  };\n\n  animate = () => {\n    if (\n      this.y + this.radius + this.velocity.y >\n      window.innerHeight - this.floorSize\n    ) {\n      this.velocity.y = -this.velocity.y * this.friction;\n      this.shatter();\n    } else {\n      this.velocity.y += this.gravity;\n    }\n\n    if (\n      this.x + this.radius + this.velocity.x > window.innerWidth ||\n      this.x - this.radius <= 0\n    ) {\n      this.velocity.x = -this.velocity.x;\n    }\n\n    this.x += this.velocity.x;\n    this.y += this.velocity.y;\n    this.ttl -= 1;\n    this.opacity -= 1 / this.ttl;\n    this.draw();\n  };\n}\n\nexport default FallingStar;\n","import React, { useRef, useEffect } from 'react';\nimport Layout from '../components/layout';\nimport FallingStar from '../classes/FallingStar';\nimport '../styles/star-shower.css';\nimport { randomIntFromRange } from '../utils';\n\nconst IndexPage = () => {\n  const canvas = useRef(null);\n  const animationFrame = useRef(null);\n  const stars = useRef([]);\n  const bgStars = useRef([]);\n  const ticker = useRef(0);\n  const floorSize = 150;\n\n  const onResizeHandler = () => {\n    setCanvasSize();\n  };\n\n  const setCanvasSize = () => {\n    canvas.current.width = window.innerWidth;\n    canvas.current.height = window.innerHeight;\n  };\n\n  const drawBgStars = ctx => {\n    if (!bgStars.current.length) {\n      Array.from(new Array(150)).forEach(() => {\n        const radius = randomIntFromRange(1, 3);\n        const x = Math.random() * canvas.current.width;\n        const y = Math.random() * canvas.current.height;\n        bgStars.current.push(new FallingStar({ ctx, x, y, radius }));\n      });\n    }\n\n    bgStars.current.forEach(star => star.draw());\n  };\n\n  const drawMountains = (ctx, numMountains, height, color) => {\n    const mountainWidth = canvas.current.width / numMountains;\n    Array.from(new Array(numMountains)).forEach((x, idx) => {\n      ctx.beginPath();\n      ctx.moveTo(idx * mountainWidth, canvas.current.height);\n      ctx.lineTo(\n        idx * mountainWidth + mountainWidth + 325,\n        canvas.current.height\n      );\n      ctx.lineTo(\n        idx * mountainWidth + mountainWidth / 2,\n        canvas.current.height - height\n      );\n      ctx.lineTo(idx * mountainWidth - 325, canvas.current.height);\n      ctx.fillStyle = color;\n      ctx.fill();\n      ctx.closePath();\n    });\n  };\n\n  const drawFloor = ctx => {\n    ctx.beginPath();\n    ctx.rect(\n      0,\n      canvas.current.height - floorSize,\n      canvas.current.width,\n      floorSize\n    );\n    ctx.fillStyle = '#182028';\n    ctx.fill();\n    ctx.closePath();\n  };\n\n  const clearCanvas = () => {\n    const ctx = canvas.current.getContext('2d');\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n    const bg = ctx.createLinearGradient(0, 0, 0, height);\n    bg.addColorStop(0, '#171e26');\n    bg.addColorStop(1, '#3f586b');\n    ctx.fillStyle = bg;\n    ctx.fillRect(0, 0, width, height);\n    drawBgStars(ctx);\n    drawMountains(ctx, 1, canvas.current.height - 100, '#384551');\n    drawMountains(ctx, 2, canvas.current.height - 300, '#2b3843');\n    drawMountains(ctx, 3, canvas.current.height - 500, '#26333e');\n    drawFloor(ctx);\n  };\n\n  const animate = spawnRate => {\n    clearCanvas();\n    stars.current.forEach((star, idx) => {\n      star.animate();\n      if (Math.floor(star.radius) <= 0) {\n        stars.current.splice(idx, 1);\n      } else {\n        star.particles.forEach((particle, pidx) => {\n          particle.animate();\n          if (!particle.ttl) {\n            star.particles.splice(pidx, 1);\n          }\n        });\n      }\n    });\n    ticker.current++;\n    const newStar = ticker.current % spawnRate === 0;\n    if (newStar) {\n      stars.current.push(getNewStar(canvas.current.getContext('2d')));\n    }\n    const nextSpawn = newStar ? randomIntFromRange(100, 200) : spawnRate;\n\n    animationFrame.current = requestAnimationFrame(() => animate(nextSpawn));\n  };\n\n  const getNewStar = ctx => {\n    const radius = 12;\n    const x = Math.max(radius, Math.random() * canvas.current.width - radius);\n    const y = -100;\n    return new FallingStar({ ctx, x, y, radius, floorSize });\n  };\n\n  useEffect(() => {\n    setCanvasSize();\n    window.addEventListener('resize', onResizeHandler);\n    animationFrame.current = animate(75);\n\n    return () => {\n      window.removeEventListener('resize', onResizeHandler);\n      cancelAnimationFrame(animationFrame.current);\n    };\n  });\n\n  return (\n    <Layout title=\"Star shower\">\n      <canvas ref={canvas} />\n    </Layout>\n  );\n};\n\nexport default IndexPage;\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { fill: require('./_array-fill') });\n\nrequire('./_add-to-unscopables')('fill');\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var aLen = arguments.length;\n  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);\n  var end = aLen > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n"],"sourceRoot":""}